dragtable = { ColumnStartIndex: 0, ColumnStopIndex: 0, dragRadius2: 100, setMinDragDistance: function (e) { dragtable.dragRadius2 = e * e }, cookieDays: 365, setCookieDays: function (e) { dragtable.cookieDays = e }, Browser: function () { var e, t, a; return this.isIE = !1, this.isNS = !1, this.version = null, t = "MSIE", (a = (e = navigator.userAgent).indexOf(t)) >= 0 ? (this.isIE = !0, void (this.version = parseFloat(e.substr(a + t.length)))) : (t = "Netscape6/", (a = e.indexOf(t)) >= 0 ? (this.isNS = !0, void (this.version = parseFloat(e.substr(a + t.length)))) : (t = "Gecko", (a = e.indexOf(t)) >= 0 ? (this.isNS = !0, void (this.version = 6.1)) : void 0)) }, browser: null, init: function () { arguments.callee.done || (arguments.callee.done = !0, _dgtimer && clearInterval(_dgtimer), document.createElement && document.getElementsByTagName && (dragtable.dragObj.zIndex = 0, dragtable.browser = new dragtable.Browser)) }, makeDraggable: function (e) { 0 == e.getElementsByTagName("thead").length && (the = document.createElement("thead"), the.appendChild(e.rows[0]), e.insertBefore(the, e.firstChild)), null == e.tHead && (e.tHead = e.getElementsByTagName("thead")[0]); for (var t = e.tHead.rows[0].cells, a = 0; a < t.length; a++) t[a].onmousedown = dragtable.dragStart }, dragObj: new Object, findUp: function (e, t) { do { if (e.nodeName && -1 != e.nodeName.search(t)) return e } while (e = e.parentNode); return null }, fullCopy: function (e, t) { var a = e.cloneNode(t); return a.className = e.className, forEach(e.style, function (t, r, o) { null != t && ("string" == typeof t && 0 == t.length || (a.style[r] = e.style[r])) }), a }, eventPosition: function (e) { return { x: (e = window.event || e).clientX + document.documentElement.scrollLeft + document.body.scrollLeft, y: e.clientY + document.documentElement.scrollTop + document.body.scrollTop } }, absolutePosition: function (e, t) { var a = 0, r = 0; do { var o = dragtable.browser.isIE ? e.currentStyle : window.getComputedStyle(e, ""), n = !(dragtable.browser.isIE && dragtable.browser.version < 7); if (t && "relative" == o.position) break; if (n && "fixed" == o.position) { a += parseInt(o.left, 10), r += parseInt(o.top, 10), a += document.body.scrollLeft, r += document.body.scrollTop; break } a += e.offsetLeft, r += e.offsetTop } while (e = e.offsetParent); return { x: a, y: r } }, dragStart: function (e, t) { var a = dragtable.dragObj, r = dragtable.browser; r.isIE ? a.origNode = window.event.srcElement : a.origNode = e.target; var o = dragtable.eventPosition(e); a.origNode = dragtable.findUp(a.origNode, /T[DH]/); var n = dragtable.findUp(a.origNode, "TABLE"); if (a.table = n, a.startCol = dragtable.findColumn(n, o.x), -1 != a.startCol) { dragtable.ColumnStartIndex = a.startCol; var l = dragtable.fullCopy(n, !1); l.style.margin = "0"; var d = function (e, t) { var a = dragtable.fullCopy(e, !1); return forEach(e.rows, function (e) { var r = e.cells[t], o = dragtable.fullCopy(e, !1); e.offsetHeight && (o.style.height = e.offsetHeight + "px"); var n = dragtable.fullCopy(r, !0); r.offsetWidth && (n.style.width = r.offsetWidth + "px"), o.appendChild(n), a.appendChild(o) }), a }; n.tHead && l.appendChild(d(n.tHead, a.startCol)), forEach(n.tBodies, function (e) { l.appendChild(d(e, a.startCol)) }), n.tFoot && l.appendChild(d(n.tFoot, a.startCol)); var i = dragtable.absolutePosition(a.origNode, !0); l.style.position = "absolute", l.style.left = i.x + "px", l.style.top = i.y + "px", l.style.width = a.origNode.offsetWidth + "px", l.style.height = a.origNode.offsetHeight + "px", l.style.opacity = .7, a.addedNode = !1, a.tableContainer = a.table.parentNode || document.body, a.elNode = l, a.cursorStartX = o.x, a.cursorStartY = o.y, a.elStartLeft = parseInt(a.elNode.style.left, 10), a.elStartTop = parseInt(a.elNode.style.top, 10), isNaN(a.elStartLeft) && (a.elStartLeft = 0), isNaN(a.elStartTop) && (a.elStartTop = 0), a.elNode.style.zIndex = ++a.zIndex, r.isIE ? (document.attachEvent("onmousemove", dragtable.dragMove), document.attachEvent("onmouseup", dragtable.dragEnd), window.event.cancelBubble = !0, window.event.returnValue = !1) : (document.addEventListener("mousemove", dragtable.dragMove, !0), document.addEventListener("mouseup", dragtable.dragEnd, !0), e.preventDefault()) } }, dragMove: function (e) { var t = dragtable.dragObj, a = dragtable.eventPosition(e), r = t.cursorStartX - a.x, o = t.cursorStartY - a.y; !t.addedNode && r * r + o * o > dragtable.dragRadius2 && (t.tableContainer.insertBefore(t.elNode, t.table), t.addedNode = !0); var n = t.elNode.style; n.left = t.elStartLeft + a.x - t.cursorStartX + "px", n.top = t.elStartTop + a.y - t.cursorStartY + "px", dragtable.browser.isIE ? (window.event.cancelBubble = !0, window.event.returnValue = !1) : e.preventDefault() }, dragEnd: function (e) { dragtable.browser.isIE ? (document.detachEvent("onmousemove", dragtable.dragMove), document.detachEvent("onmouseup", dragtable.dragEnd)) : document.removeEventListener("mousemove", dragtable.dragMove, !0); var t = dragtable.dragObj; if (t.addedNode) { t.tableContainer.removeChild(t.elNode); var a = dragtable.eventPosition(e), r = dragtable.absolutePosition(t.table); if (!(a.y < r.y || a.y > r.y + t.table.offsetHeight)) { var o = null == $(".DTFC_LeftHeadWrapper").width() ? 0 : $(".DTFC_LeftHeadWrapper").width(); if (!(a.x < o + r.x)) { var n = dragtable.findColumn(t.table, a.x); if (dragtable.ColumnStopIndex = n, -1 != n && n != t.startCol) { dragtable.moveColumn(t.table, t.startCol, n), dragtable.TableDragMoveColumn(); for (var l = "", d = jQuery("th", t.table), i = 0; i < d.length; i++) { var s = d[i].getAttribute("class"); null != s && (l += s + ",") } dragtable.createCookie("colShow_" + dragtable.user, l, 365) } } } } }, findColumn: function (e, t) { var a = e.tHead.rows[0].cells, r = 0, o = $(".dataTables_scrollHead").scrollLeft(), n = $(".tdragTable").parent().scrollLeft(); r = null == o ? n : o; for (var l = 0; l < a.length; l++) { a[l].offsetWidth; var d = dragtable.absolutePosition(a[l]); if (d.x - r <= t && t <= d.x + a[l].offsetWidth - r) return l } return -1 }, TableDragMoveColumn: function () { $(".dataTables_scrollBody .tdragTable").find("tr").each(function () { _column = $(this).find("th, td"), dragtable.ColumnStartIndex > dragtable.ColumnStopIndex ? _column.eq(dragtable.ColumnStartIndex).detach().insertBefore(_column.eq(dragtable.ColumnStopIndex)) : _column.eq(dragtable.ColumnStartIndex).detach().insertAfter(_column.eq(dragtable.ColumnStopIndex)) }) }, moveColumn: function (e, t, a) { for (var r, o = e.rows.length; o--;) { var n = (r = e.rows[o]).removeChild(r.cells[t]); a < r.cells.length ? r.insertBefore(n, r.cells[a]) : r.appendChild(n) } var l = e.tHead.rows[0].cells; for (o = 0; o < l.length; o++) l[o].sorttable_columnindex = o }, user: "default", setUsers: function (e) { dragtable.user = e }, rememberDrag: function (e, t) { var a = dragtable.user, r = dragtable.readCookie(a), o = ""; r && (o = r + ","), o += e + "/" + t, dragtable.createCookie(a, o, dragtable.cookieDays) }, replayDrags: function (e) { if (dragtable.cookiesEnabled()) { var t = dragtable.readCookie(dragtable.user); if (t) for (var a = t.split(","), r = 0; r < a.length; r++) { var o = a[r].split("/"); if (2 == o.length) { var n = parseInt(o[0]), l = parseInt(o[1]); isNaN(n) || isNaN(l) || dragtable.moveColumn(e, n, l) } } } }, createCookie: function (e, t, a) { if (a) { var r = new Date; r.setTime(r.getTime() + 24 * a * 60 * 60 * 1e3); var o = "; expires=" + r.toGMTString() } else o = ""; document.cookie = e + "=" + t + o }, readCookie: function (e) { for (var t = e + "=", a = document.cookie.split(";"), r = 0; r < a.length; r++) { for (var o = a[r]; " " == o.charAt(0) ;) o = o.substring(1, o.length); if (0 == o.indexOf(t)) return o.substring(t.length, o.length) } return null }, eraseCookie: function (e) { dragtable.createCookie(e, "", -1) } }; var dgListenOnLoad = !1; if (document.addEventListener && (dgListenOnLoad = !0, document.addEventListener("DOMContentLoaded", dragtable.init, !1)), /WebKit/i.test(navigator.userAgent)) { dgListenOnLoad = !0; var _dgtimer = setInterval(function () { /loaded|complete/.test(document.readyState) && dragtable.init() }, 10) } dgListenOnLoad || (window.onload = dragtable.init), Array.forEach || (Array.forEach = function (e, t, a) { for (var r = 0; r < e.length; r++) t.call(a, e[r], r, e) }), Function.prototype.forEach = function (e, t, a) { for (var r in e) void 0 === this.prototype[r] && t.call(a, e[r], r, e) }, String.forEach = function (e, t, a) { Array.forEach(e.split(""), function (r, o) { t.call(a, r, o, e) }) }; var forEach = function (e, t, a) { if (e) { var r = Object; if (e instanceof Function) r = Function; else { if (e.forEach instanceof Function) return void e.forEach(t, a); "string" == typeof e ? r = String : "number" == typeof e.length && (r = Array) } r.forEach(e, t, a) } }; function hideColumn(e) { if (0 == document.getElementById(e.id).checked) { var t = $(e).attr("class").valueOf(); tagName = t, $("th." + t).hide(), $("td." + t).hide() } else $("th." + e.className).show(), $("td." + e.className).show() } function initDrag() { arguments.callee.done = !0, _dgtimer && clearInterval(_dgtimer), document.createElement && document.getElementsByTagName && (dragtable.dragObj.zIndex = 0, dragtable.browser = new dragtable.Browser, forEach(document.getElementsByTagName("table"), function (e) { e.className.search(/\bdraggable\b/) })) } function setCookie(e, t, a) { try { var r = new Date; r.setTime(r.getTime() + 24 * a * 60 * 60 * 1e3); var o = r.toUTCString(); document.cookie = e + "=" + t + ";expires=" + o } catch (e) { alert(e.message) } } function getCookie(e) { try { for (var t = e + "=", a = document.cookie.split(";"), r = 0; r < a.length; r++) { for (var o = a[r]; " " == o.charAt(0) ;) o = o.substring(1); if (-1 != o.indexOf(t)) return o.substring(t.length, o.length) } return "" } catch (e) { return alert(e.message), "" } } function removeCookie(e) { try { setCookie(e, "", -1) } catch (e) { alert(e.message) } } function checkCookie() { var e = getCookie("username"); "" != e ? alert("Welcome again " + e) : "" != (e = prompt("Please enter your name:", "")) && null != e && setCookie("username", e, 365) }
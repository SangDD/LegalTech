@model string
@using ObjectInfos;

@{
    BussinessFacade.ModuleUsersAndRoles.UserBL _UserBL = new BussinessFacade.ModuleUsersAndRoles.UserBL();
    List<UserInfo> _lstUsersCustomer = _UserBL.GetUserByType(Convert.ToDecimal(Common.CommonData.CommonEnums.UserType.Customer));
    //var lstUsersCustomer = _lstUsersCustomer.Select(x => new SelectListItem { Text = x.FullName, Value = x.Username });
    var lstUsersCustomer = new List<SelectListItem> { new SelectListItem { Text = "Chọn khách hàng", Value = "0" } }.Concat(_lstUsersCustomer.Select(x => new SelectListItem { Text = x.FullName, Value = x.Username }));

    decimal _user_type = 0;
    if (WebApps.Session.SessionData.CurrentUser != null)
    {
        _user_type = WebApps.Session.SessionData.CurrentUser.Type;
    }
}

@if (WebApps.Session.SessionData.CurrentUser.Type == (int)Common.CommonData.CommonEnums.UserType.SupperAdmin
            || WebApps.Session.SessionData.CurrentUser.Type == (int)Common.CommonData.CommonEnums.UserType.Admin
            || WebApps.Session.SessionData.CurrentUser.Type == (int)Common.CommonData.CommonEnums.UserType.Lawer)
{
    <div class="divCover cls_form_title">
        <img src="~/Content/icons/info_2.png" />
        <div class="cls_form_header">
            Chọn khách hàng
        </div>
    </div>


    <div class="div-search-ad">
        <div class="div-search-title">
            <div> Khách hàng:</div>
        </div>
        <div class="div-search-content">
            <div>
                @Html.DropDownList("Created_By", lstUsersCustomer, new { @id = "cbo_Created_By" })
            </div>
        </div>
    </div>
}
<script>
    function funcThongTinNhapHo(formData) {
        try {

            if (@_user_type == '@Convert.ToDecimal(Common.CommonData.CommonEnums.UserType.SupperAdmin)'
                || @_user_type == '@Convert.ToDecimal(Common.CommonData.CommonEnums.UserType.Admin)'
                    || @_user_type =='@Convert.ToDecimal(Common.CommonData.CommonEnums.UserType.Lawer)')
            {
                var _createdby = $("#cbo_Created_By").val();
                if (_createdby == "0") {
                    $('#cbo_Created_By').focus();
                    showError('Bạn chưa chọn khách hàng khai hộ đơn!');
                    return false;
                }
                formData.append("pInfo.Created_By", _createdby);
            }

            return true;
        } catch (e) {
            return false;
        }
    }
</script>



